
ubuntu@sandbox-node2:~$ sudo kubectl get pvc -n awx
NAME                            STATUS    VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   VOLUMEATTRIBUTESCLASS   AGE
awx-projects-claim              Pending                                                                        local-path     <unset>                 2d2h
postgres-15-awx-postgres-15-0   Bound     pvc-4d925fab-2fb3-4e3f-b199-196f4374881d   8Gi        RWO            local-path     <unset>                 2d2h

ubuntu@sandbox-node2:~$ sudo kubectl get storageclass
NAME                   PROVISIONER             RECLAIMPOLICY   VOLUMEBINDINGMODE      ALLOWVOLUMEEXPANSION   AGE
local-path (default)   rancher.io/local-path   Delete          WaitForFirstConsumer   false                  2d19h
ubuntu@sandbox-node2:~$

ubuntu@sandbox-node2:~$ sudo kubectl patch storageclass local-path -p '{"volumeBindingMode":"Immediate"}'
The StorageClass "local-path" is invalid: volumeBindingMode: Invalid value: "Immediate": field is immutable

ubuntu@sandbox-node2:~$ sudo kubectl get storageclass local-path -o yaml | grep volumeBindingMode
volumeBindingMode: WaitForFirstConsumer
ubuntu@sandbox-node2:~$

cat <<EOF | kubectl apply -f -
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: local-path-immediate
provisioner: rancher.io/local-path
reclaimPolicy: Delete
volumeBindingMode: Immediate
EOF

ubuntu@sandbox-node2:~$ sudo kubectl get pvc -n awx
NAME                            STATUS    VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS           VOLUMEATTRIBUTESCLASS   AGE
awx-projects-claim              Pending                                                                        local-path-immediate   <unset>                 5m45s
postgres-15-awx-postgres-15-0   Bound     pvc-4d925fab-2fb3-4e3f-b199-196f4374881d   8Gi        RWO            local-path             <unset>                 2d2h
ubuntu@sandbox-node2:~$ sudo kubectl get pods -n awx
NAME                                               READY   STATUS    RESTARTS   AGE
awx-operator-controller-manager-58b7c97f4b-mncsk   2/2     Running   0          64s
awx-postgres-15-0                                  1/1     Running   0          62s
awx-task-55f5964cb4-f8sqh                          0/4     Pending   0          63s
awx-task-6b9698bbdd-gtdsx                          0/4     Pending   0          63s
awx-web-585dd589c5-htl9d                           0/3     Pending   0          63s
awx-web-6cc598b7-ll77h                             0/3     Pending   0          63s
ubuntu@sandbox-node2:~$

ubuntu@sandbox-node2:~$ sudo kubectl logs -n kube-system deployment/local-path-provisioner
I1224 16:52:48.114961       1 event.go:389] "Event occurred" object="awx/awx-projects-claim" fieldPath="" kind="PersistentVolumeClaim" apiVersion="v1" type="Warning" reason="ProvisioningFailed" message="failed to provision volume with StorageClass \"local-path-immediate\": NodePath only supports ReadWriteOnce and ReadWriteOncePod (1.22+) access modes"
I1224 16:53:16.140588       1 controller.go:968] "Retrying syncing claim because failures < threshold" key="10a1dffc-87d3-41d4-8cf7-53fb3bb4cd8f" failures=5 threshold=15
E1224 16:53:16.140695       1 controller.go:988] "Unhandled Error" err="error syncing claim \"10a1dffc-87d3-41d4-8cf7-53fb3bb4cd8f\": failed to provision volume with StorageClass \"local-path-immediate\": NodePath only supports ReadWriteOnce and ReadWriteOncePod (1.22+) access modes" logger="UnhandledError"
I1224 16:53:16.140942       1 event.go:389] "Event occurred" object="awx/awx-projects-claim" fieldPath="" kind="PersistentVolumeClaim" apiVersion="v1" type="Normal" reason="Provisioning" message="External provisioner is provisioning volume for claim \"awx/awx-projects-claim\""
I1224 16:53:16.141125       1 event.go:389] "Event occurred" object="awx/awx-projects-claim" fieldPath="" kind="PersistentVolumeClaim" apiVersion="v1" type="Warning" reason="ProvisioningFailed" message="failed to provision volume with StorageClass \"local-path-immediate\": NodePath only supports ReadWriteOnce and ReadWriteOncePod (1.22+) access modes"

ubuntu@sandbox-node2:~$ sudo kubectl logs -n kube-system deployment/local-path-provisioner
I1224 17:07:48.115185       1 event.go:389] "Event occurred" object="awx/awx-projects-claim" fieldPath="" kind="PersistentVolumeClaim" apiVersion="v1" type="Normal" reason="Provisioning" message="External provisioner is provisioning volume for claim \"awx/awx-projects-claim\""
I1224 17:07:48.115213       1 event.go:389] "Event occurred" object="awx/awx-projects-claim" fieldPath="" kind="PersistentVolumeClaim" apiVersion="v1" type="Warning" reason="ProvisioningFailed" message="failed to provision volume with StorageClass \"local-path-immediate\": configuration error, no node was specified"
I1224 17:08:21.518242       1 controller.go:968] "Retrying syncing claim because failures < threshold" key="dc91c20f-f832-4124-8316-9080de6d3671" failures=4 threshold=15
E1224 17:08:21.518373       1 controller.go:988] "Unhandled Error" err="error syncing claim \"dc91c20f-f832-4124-8316-9080de6d3671\": failed to provision volume with StorageClass \"local-path-immediate\": configuration error, no node was specified" logger="UnhandledError"
I1224 17:08:21.518496       1 event.go:389] "Event occurred" object="awx/awx-projects-claim" fieldPath="" kind="PersistentVolumeClaim" apiVersion="v1" type="Normal" reason="Provisioning" message="External provisioner is provisioning volume for claim \"awx/awx-projects-claim\""
I1224 17:08:21.518615       1 event.go:389] "Event occurred" object="awx/awx-projects-claim" fieldPath="" kind="PersistentVolumeClaim" apiVersion="v1" type="Warning" reason="ProvisioningFailed" message="failed to provision volume with StorageClass \"local-path-immediate\": configuration error, no node was specified"
